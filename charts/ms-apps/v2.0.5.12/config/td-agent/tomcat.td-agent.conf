<source>
    @type tail
    format multiline
    multiline_flush_interval 30s
    format_firstline /^(?<time>\d{4}-\d{1,2}-\d{1,2} \d{1,2}:\d{1,2}:\d{1,2},\d{3})/
    format1 /(?<time>\d{4}-\d{1,2}-\d{1,2} \d{1,2}:\d{1,2}:\d{1,2},\d{3}) (?<message>.*\s*)$/
    path /opt/MetricStream/SYSTEMi/Systemi/log/client_*.log
    pos_file /opt/MetricStream/SYSTEMi/Systemi/log/client.log
    tag application.logs
</source>

<filter application.logs>
    @type record_transformer
    <record>
        hostname ${hostname}
    </record>
</filter>

<match application.logs>
    @type elasticsearch
    host elasticsearch-logging
    port 9200
    logstash_format true
    logstash_prefix application.logs
</match>

<source>
    @type tail
    #format /(?<time>\d{1,2}-[a-zA-Z]{3}-\d{4} \d{2}:\d{2}:\d{2}.\d{3}) (?<message>.*\s*)$/
    format multiline
    multiline_flush_interval 30s
    format_firstline /^(?<time>\d{1,2}-[a-zA-Z]{3}-\d{4} \d{2}:\d{2}:\d{2}.\d{3})/
    format1 /(?<time>\d{1,2}-[a-zA-Z]{3}-\d{4} \d{2}:\d{2}:\d{2}.\d{3}) (?<message>.*\s*)$/
    path /tomcat/logs/catalina*.log
    pos_file  /tomcat/logs/catalina.log.pos
    tag catalina.logs
</source>

<filter catalina.logs>
    @type record_transformer
    <record>
        hostname ${hostname}
    </record>
</filter>

<match catalina.logs>
    @type elasticsearch
    host elasticsearch-logging
    port 9200
    logstash_format true
    logstash_prefix catalina.logs
</match>


<source>
    @type tail
    format multiline
    multiline_flush_interval 30s
    format /^(?<time>.+) (?<stream>stdout|stderr) [^ ]* (?<log>.*)$/
    #format_firstline /^(?<time>\d{1,2}-[a-zA-Z]{3}-\d{4} \d{2}:\d{2}:\d{2}.\d{3})/
    path /var/log/containers/tomcat*.log
    pos_file  /tomcat/logs/tomcat.log.pos
    tag tomcat.logs
</source>

<filter tomcat.logs>
    @type record_transformer
    <record>
        hostname ${hostname}
        pod_name "#{ENV['POD_NAME']}"
        pod_namespace "#{ENV['POD_NAMESPACE']}"
    </record>
</filter>

<match tomcat.logs>
    @type elasticsearch
    host elasticsearch-logging
    port 9200
    logstash_format true
    logstash_prefix tomcat.logs
</match>
